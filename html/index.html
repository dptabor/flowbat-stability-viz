<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Flow Battery Stability Comparison</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon"> 

        <link rel="stylesheet" href="vendor/normalize.min.css">

        <script src="vendor/modernizr-2.8.3.min.js"></script>
        <script src="vendor/d3-4.2.6.min.js"></script>

        <script src="vendor/jquery-2.2.3.min.js"></script>

        <script src="vendor/datatables/js/jquery.dataTables.min.js"></script>
        <link rel="stylesheet" href="vendor/datatables/css/jquery.dataTables.min.css">
        <script src="vendor/datatables/js/dataTables.buttons.min.js"></script>
        <link rel="stylesheet" href="vendor/datatables/css/buttons.dataTables.min.css">
        <script src="vendor/datatables/js/dataTables.select.min.js"></script>
        <link rel="stylesheet" href="vendor/datatables/css/select.dataTables.min.css">

        <script src="vendor/qtip/jquery.qtip.min.js"></script>
        <link rel="stylesheet" href="vendor/qtip/jquery.qtip.min.css">
    </head>
    <body>
        <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

        <main id="main">
        </main>

	<script>
		// The 'CFG' variable gets decorated by the scripts below.
		var CFG = {}
	</script>

        <script src="js/main.js"></script>
        <script>

		CFG.cssPromise = new Promise((resolve, reject) => {
				var junk = Math.random() 
				var link = document.createElement("link");
				link.href = "css/main.css?junk="+junk;
				link.type = "text/css";
				link.rel = "stylesheet";
				document.getElementsByTagName("head")[0].appendChild(link);
				resolve()
				})

                CFG.dataPromise = new Promise((resolve, reject) => {
                        let fakeData = {
                            stability_window: {
                                points: [
                                    {ph: 0, ev: 1.230},
                                    {ph: 14, ev: 0.404},
                                    {ph: 14, ev: -0.826},
                                    {ph: 0, ev: 0.118}
                                ]
                            },
                            molecules: [...Array(3).keys()].map((i) => ({
                                id: `molecule-${i}`,
                                label: `Molecule_${i}`,
                                tags: [1, 2, 3].map(t => `tag_${i}_${t}`),
                                points: [...Array(12).keys()].map((j) => ({
                                    ph: j, ev: (1.5 - 1.5 * Math.random())
                                }))
                            }))
                        }
                        resolve(fakeData)
                    })
		CFG.renderDataSource = () => 'DataSource: -not specified-'
	</script>

	<script src="cfg.prod.js"></script>
	<script>
Object.assign(CFG, productionCFG)</script>

	<script>
            $(document).ready(function () {
		Promise.all([CFG.cssPromise, CFG.dataPromise]).then(() => {
		   main(CFG)
		})
            })
        </script>
    </body>
</html>
